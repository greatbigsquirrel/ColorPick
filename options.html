<html>
<head><title>ColorPicker Options</title>
<style>
	label{display:block;}
	body{max-width:1000px;}
	h3{margin:4px;}
</style>
<script type="text/javascript">

var pOptions=[];
var pAdvOptions=[];
//pOptions["maxhistory"]={def:15,ind:0,name:'Max History per Window '};
//pOptions["dothumbs"]={def:false,ind:0,name:'Collect Thumbnails'};
//pOptions["hqthumbs"]={def:false,ind:1,name:'HQ Thumbnails (more ram) '};

//WARNIGN you have to set defaults two places for now...
pOptions["pickEveryTime"]={def:true,ind:0,name:'Start picking agian each time icon is clicked'}; //default false in popup.html
pOptions["pixelatedPreview"]={adv:false,def:true,ind:0,name:'Zoomed preview is Pixelated'};
pOptions["fishEye"]={def:5,ind:1,name:'Fish Eye Amount',select:{1:'1 Off',2:2,3:3,4:4,5:'5 default',6:6,7:7,8:8,9:'9 Full',10:10,11:11,12:12,13:13,14:14,15:'15 Max Zoomed'}};
pOptions["EnableRGB"]={def:true,ind:0,name:'Show RGB'};
pOptions["EnableHSL"]={def:true,ind:0,name:'Show HSL'};
pOptions["useCSSValues"]={def:true,ind:0,name:'Use CSS values for RGB/HSL'};
pOptions["showPreviewInContentS"]={def:false,ind:0,name:'Show image preview near cursor while picking'};
pOptions["ShowRGBHSL"]={def:false,ind:1,name:'Show RGB and HSL too'};
pOptions["contSprevZoomd"]={def:false,ind:1,name:'Large size preview'};
pOptions["iconIsBitmap"]={def:false,ind:0,name:'Icon is zoomed colorpick pixel preview'};
pOptions["resetIcon"]={def:false,ind:1,name:'Reset icon between color picks'};
pOptions["iconIsPreview"]={def:false,ind:0,name:'Use icon badge square color preview: ',img:'opt_badge.png'};
pAdvOptions["customCalibration"]={def:false,ind:0,name:'Enable usage of the calibration link above. [required for win XP or Themes Disabled]'};
pAdvOptions["autocopyhex"]={def:false,ind:0,name:'Attempt auto-copy the hex to the clipboard'};
pAdvOptions["bbackgroundColor"]={def:'#FFF',ind:0,name:'Popup Background Color ("#FFFFFF" or "blue")'};
pAdvOptions["usePrevColorBG"]={def:false,ind:1,name:'Use Previous Color for Background Instead'};
pAdvOptions["showPreviousClr"]={def:true,ind:0,name:'Show Split color Preview with Previous Color'};
pAdvOptions["borderValue"]={def:'1px solid grey',ind:0,name:'Borders to use ("1px solid #000" or "none")'};
//pOptions["flashScalePix"]={def:false,ind:0,name:'Flash approximate Precision during Page Zoom (NOT recommended - use calibrate below instead)'};
//pOptions["localflScalePix"]={def:false,ind:1,name:'Local Flash Scale Pixel? (read help)'};
pAdvOptions["usePNG"]={def:true,ind:0,name:'Use PNG quality when available'};
pAdvOptions["clrAccuracyOverPrecision"]={def:false,ind:0,name:'ColorAccuracyOverPrecision - Improves color accuracy but decreases location accuracy.  Negative: possibly inaccessible page locations.'};
pAdvOptions["showActualPickTarget"]={def:false,ind:1,name:'ShowActualPickTarget - Helps a great deal when the above is checked, you see the image you\'re picking from instead of the webpage.'};
pAdvOptions["appleIcon"]={def:false,ind:0,name:'Use Apple color picker logo'};
pAdvOptions["autoRedirectPickable"]={def:false,ind:0,name:'Automatically redirect to a pickable version when unavailable'};
pAdvOptions["redirectSameWindow"]={def:false,ind:1,name:'Use the same window (warning: you may lose form data)'};
pOptions["shareClors"]={def:false,ind:0,name:'Share Colors - Color of the Day statistics'};


//pOptions["previewOnPage"]={def:false,ind:0,name:'On page zoomed preview'};

// Saves options to localStorage.
function save_options() {
//  var select = document.getElementById("color");
//  var color = select.children[select.selectedIndex].value;
//  localStorage["favorite_color"] = color;
  	
  	for( i in pOptions){
  		if(typeof(pOptions[i].def)=='boolean')
  			localStorage[i] = document.getElementById(i).checked;
  		else
  			localStorage[i] = document.getElementById(i).value;
  	}
	
	
		for( i in pAdvOptions){
  		if(typeof(pAdvOptions[i].def)=='boolean')
  			localStorage[i] = document.getElementById(i).checked;
  		else
  			localStorage[i] = document.getElementById(i).value;
  	}
	//localStorage["hqthumbs"] = document.getElementById("hqthumbs").checked;
	//localStorage["showCurrentTab"] = document.getElementById("showCurrentTab").checked;
	//localStorage["maxhistory"] = document.getElementById("maxhistory").value;
	
	var iconbitmap=false;
	var appleIcon=false;
	
	if(typeof(localStorage["iconIsBitmap"])!='undefined')iconbitmap = ((localStorage["iconIsBitmap"]=='true')?true:false);
	if(typeof(localStorage["appleIcon"])!='undefined')appleIcon = ((localStorage["appleIcon"]=='true')?true:false);
	if(!iconbitmap){
		var iconPath='';
		if(appleIcon)iconPath='apple/';
		chrome.browserAction.setIcon({path:chrome.extension.getURL(iconPath+'icon19.png')});//update icon (to be configurable)
	}
	
  // Update status to let user know options were saved.
  var status = document.getElementById("status");
  status.innerHTML = "Options Saved.";
  setTimeout(function() {
    status.innerHTML = "";
  }, 750);
  
  chrome.extension.sendRequest({greeting: "reloadprefs"}, function(response) { });
}

function reset_options() {
	for( i in pOptions){
		if(typeof(pOptions[i].def)=='boolean')
			document.getElementById(i).checked = pOptions[i].def;
		else
			document.getElementById(i).value = pOptions[i].def;
	}
	
	for( i in pAdvOptions){
		if(typeof(pAdvOptions[i].def)=='boolean')
			document.getElementById(i).checked = pAdvOptions[i].def;
		else
			document.getElementById(i).value = pAdvOptions[i].def;
	}
	
	var status = document.getElementById("status");
  status.innerHTML = "You still need to press save, defaults are showing now.";
  setTimeout(function() {
    status.innerHTML = "";
  }, 1750);
}

// Restores select box state to saved value from localStorage.
function restore_options() {
	for( i in pOptions){
		if(typeof(pOptions[i].def)=='boolean')
			document.getElementById(i).checked = ((localStorage[i]=='true')?true:pOptions[i].def);
		else
			document.getElementById(i).value = ((localStorage[i])?localStorage[i]:pOptions[i].def);
	}
	
	for( i in pAdvOptions){
		if(typeof(pAdvOptions[i].def)=='boolean')
			document.getElementById(i).checked = ((localStorage[i]=='true')?true:pAdvOptions[i].def);
		else
			document.getElementById(i).value = ((localStorage[i])?localStorage[i]:pAdvOptions[i].def);
	}

//  var favorite = localStorage["favorite_color"];
//  if (!favorite) {
//    return;
//  }
//  var select = document.getElementById("color");
//  for (var i = 0; i < select.children.length; i++) {
//    var child = select.children[i];
//    if (child.value == favorite) {
//      child.selected = "true";
//      break;
//    }
//  }
}


function load_history(){
	if(typeof(localStorage["colorPickHistory"])=='undefined')localStorage['colorPickHistory']="";
	var hist=localStorage['colorPickHistory'].split("#");
	var div_history=document.getElementById('history');
	div_history.innerHTML = '';
	for(i in hist){
		if(!hist[i])continue;
		var cb=document.createElement('div');
		cb.setAttribute('style','display:inline-block;background-color:#'+hist[i]+';width:22px;height:22px;');
		cb.setAttribute('title','#'+hist[i]);
		div_history.appendChild(cb);
		cb.addEventListener('click',function(){
			prompt('#'+hist[i],hist[i],hist[i]);
		},false);
	}
}

function createOptions(piOptions, elemAppend){
	//needs some compression 
	for( i in piOptions){
		if(piOptions[i].select){
			var l=document.createElement('label');
			var cb=document.createElement('select');
			cb.setAttribute('type','select');
			cb.setAttribute('id',i);
			if(piOptions[i].ind>0)l.appendChild(document.createTextNode('\u00a0\u00a0\u00a0\u00a0'));
			if(piOptions[i].ind>1)l.appendChild(document.createTextNode('\u00a0\u00a0\u00a0\u00a0'));
			l.appendChild(document.createTextNode(piOptions[i].name));
			l.appendChild(cb);
			
			
			for(z in piOptions[i].select){
				var opt=document.createElement('option');
				opt.setAttribute('value',z);
				opt.appendChild(document.createTextNode(piOptions[i].select[z]));
				cb.appendChild(opt);
			}
			
			elemAppend.appendChild(l);
			//document.getElementById('bsave').parentNode.insertBefore(l,document.getElementById('bsave'));
		}else if(typeof(piOptions[i].def)=='boolean'){
			var l=document.createElement('label');
			var cb=document.createElement('input');
			cb.setAttribute('type','checkbox');
			cb.setAttribute('id',i);
			if(piOptions[i].ind>0)l.appendChild(document.createTextNode('\u00a0\u00a0\u00a0\u00a0'));
			if(piOptions[i].ind>1)l.appendChild(document.createTextNode('\u00a0\u00a0\u00a0\u00a0'));
			l.appendChild(cb);
			l.appendChild(document.createTextNode(piOptions[i].name));
			if(piOptions[i].img){
				var t=piOptions[i].img;
				i=document.createElement('image');
				i.setAttribute('src',t);
				i.setAttribute('align','top');
				l.appendChild(i);
			}
			elemAppend.appendChild(l);
			//document.getElementById('bsave').parentNode.insertBefore(l,document.getElementById('bsave'));
			//.getElementById(i).checked = ((localStorage[i]=='true')?true:piOptions[i].def);
		}else{
			var l=document.createElement('label');
			var cb=document.createElement('input');
			cb.setAttribute('type','text');
			cb.setAttribute('id',i);cb.setAttribute('size',(piOptions[i].def + '').length);
			if(piOptions[i].ind>0)l.appendChild(document.createTextNode('\u00a0\u00a0\u00a0\u00a0'));
			l.appendChild(cb);
			l.appendChild(document.createTextNode(piOptions[i].name));
			
			elemAppend.appendChild(l);
			//document.getElementById('bsave').parentNode.insertBefore(l,document.getElementById('bsave'));
			//document.getElementById(i).value = ((localStorage[i])?localStorage[i]:piOptions[i].def);
		}
	}
}

function init(){
	
	var a=document.getElementById('dupli');
	var b=a.cloneNode(true);
	b.id='nota';
	b.style.color='black';
	b.style.position='absolute';
	b.style.top='1px';b.style.left='1px';
	a.appendChild(b);
	
	createOptions(pOptions, document.getElementById('options'));
	createOptions(pAdvOptions, document.getElementById('adv_options'))
	restore_options();
	
	
	load_history();
}

</script>
</head>
<body onload="init()" style="background-image:url(bg1.jpg);">

<div style="float:right;">
	
<br/>Making money using ColorPick? <a href="http://www.vidzbigger.com/index.php?v=donate&colorpick=true&amount=5.00#donate">Donate</a>

<div style="clear:both;">

<img src="win32.png" style="float:left;margin-right:22px;" />

	<h4>Win32 and OSX ColorPick</h4>
	
	Coming Soon!  Get Excited!

	
	<!--
	Fast - Light Weight - Easy
	<br/><br/>
	Pick colors anywhere on screen!
	<br/><br/>
	Individual licenses start at $1 USD
	<br/><br/>
<a href="http://vidsbee.com/ColorPick" style="text-decoration:none;"><input type="button" value="Buy Now"><br/> PayPal or Google Wallet</a>
-->

	<!--
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="U95A2Y5PAQABG">
<table>
<tr><td><input type="hidden" name="on0" value="Order">Order</td></tr><tr><td><select name="os0">
	<option value="ColorPick Win32">ColorPick Win32 $3.00 USD</option>
	<option value="ColorPick Chrome Extension License">ColorPick Chrome Extension License $1.00 USD</option>
	<option value="ColorPick All Editions Lifetime License">ColorPick All Editions Lifetime License $10.00 USD</option>
</select> </td></tr>
</table>
<input type="hidden" name="currency_code" value="USD">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
-->
	
</div>
		<br style="clear:both;" /><hr/>
<div id="dupli" style="display:block;position:relative;width:450px;margin-bottom:30px;color:white;left:0px;"><a href="javascript:void(0)" onclick="var nss=this.nextSibling.style;if(nss.display=='block')nss.display='none';else nss.display='block';">Help</a><div id="allhelp" style="display:none;">
	<br/><br/>On a standard http:// webpage click the icon then move your mouse pointer over the webpage to pick colors.  On a mac you may have to pop out the preview window using <img src="popout.gif" />.  
	
	<br/><br/>A <a href="http://ficml.org/jemimap/style/color/wheel.html">Color Wheel</a> to test with.  You may have to test with a website instead of an image unfortunately, although for some it may work on image URLs as well, most will have to enable Automatically redirect to have this feature.

	<br/><br/>Some notes about scrolling - when you scroll the window the program has to take another snapshot of the screen for you to pick colors from.  There is a delay while this occurs so the results of scrolling or resizing will not be immediate.  There is also a chance that the screenshot will include the preview box.  If this happens move your mouse before you scroll or click the ColorPicker icon again.
	
	<br/><br/>Quick trick - if the preview is ever out of sync, there's no need to click the icon again, you can usually scroll the page using the mousewheel which will refresh the preview.  You can also press [r] or [j].  [esc] exits the picker.  
	
	<br/><br/>Pro tip - If you are moving your mouse while scrolling it is possible to trigger mouse over events.  Target the element you want to activate, then scroll down one click using the mousewheel.  Next slowly slide your mouse horizontally while you scroll the mousewheel up one click again.  The element you targeted should now be activated allowing you to pick colors from mouseover states of buttons.  The hotkeys [r] or [j] also allow mouse interaction for a small window.
	
	<br/><br/>Hint: If you zoom the popup window or this window, the color picker preview popup will always appear at the zoom you set here or in the popup window (control scroll or ctrl +/-)  To zoom the page you sample from use <a href="calibrate.html" title="Use this to allow normal browser level scaling of the page while you sample colors">Calibrate</a>.
	
	<br/><br/>If you switch to a page that is zoomed in, you may find portions of the screen are solid black pixels.  This can be correctd by pressing [r] to refresh the snapshot of the page.  

<br/><br/><small>Note: zooming this page is not supported, it may cause other things to be zoomed too, such as the picker, which may be good, and it may produce funny results too, it will also cause the pop-out version of the pop-up to be zoomed, you can use this pop-out to adjust or reset zoom.  Ctrl-Zero resets the page zoom.  Try the calibrate feature.</small>
	
	<!--
<br/><br/><b>Local Flash Scale Pixel (this feature may no longer be relevant)</b>:<br/>
	In order to get the Local Flash Scale Pixel working, you need to add permissions so that the extension is allowed to run flash files that are stored in the extension (as opposed to on my remote server)
	To accomplish this simply visit this page
	<a target="_blank" href="http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html">Flash Security Settings</a>
	and click on Edit Locations dropdown, the select add location and paste <input onmouseover="this.focus();this.select()" type="text" value="chrome-extension://ohcpnigalekghcmgcdcenkpelffpdolg/*" /> to the list of approved URLs.  To allow flash for all extensions you can possibly add chrome-extensions://*
	-->
	
	<br/><br/>If it doesn't seem to be working, make sure you are on an http:// or https:// page and not on the extensions site.  Refresh the page if you just enabled ColorPicker.  You have to wait until the page is fully loaded before clicking color picker.
	
	<br/><br/>Does not always work with flash objects, try adding wmode="opaque" to the embed code.
	
	<br/><br/><big><b>Keyboard Controls</b></big><br/>
	<b>esc</b> - exit picker<br/>
	<b>r</b> or <b>j</b> - refresh (pick from new snapshot, useful for brief interaction)<br/>
	<b>enter</b> - pick color (useful if you do not want to or can't press mouse)<br/>
	<u><b>From Pop-up Only</b></u><br/>
	<b>arrow keys</b> - move pixel (when picking mode is active)<br/>
	<b>enter</b> - pick color, toggle pick mode (arrows and mouse currently incompatible)<br/>
	
	<br/><br/>This software is beta and is provided as is, please provide feedback for improvements at <a href="http://www.vidzbigger.com/index.php?v=contact">vidzbigger.com/contact</a>  Thanks!
</div>
</div>


</div><div style="position:relative;width:399px">
	<h3><img src="icon32.png" align="top"/> ColorPick Preferences</h3>

<div id="options">
	
</div>

<a style="display:block" href="javascript:void(0)" onclick="var ns=this.nextSibling;if(ns.style.display=='block'){ns.style.display='none'}else{ns.style.display='block'}">Advanced Options</a><div id="adv_options" style="display:none;">
	<a href="calibrate.html" title="Use this to allow normal browser level scaling of the page while you sample colors">Calibrate Theme Scale</a><br/>
	<!-- advanced -->
</div>

<button onclick="save_options()" id="bsave">Save</button> <button onclick="reset_options()" id="defa">Show Defaults</button><br><br>
<span id="status"></span> &nbsp; 

<h4>Hisotry <a href="javascript:void(0)" onclick="localStorage['colorPickHistory']='';load_history();" style="font-size:10px;">clear</a></h4>
<div id="history"></div>

<!--(Dissable <b>Flash approximate Precision during Page Zoom</b>, if you are using this calibrate, as calibrate is more accurate and once only)-->
</div>


</body>
</html>